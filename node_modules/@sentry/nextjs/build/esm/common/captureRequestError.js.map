{"version":3,"file":"captureRequestError.js","sources":["../../../src/common/captureRequestError.ts"],"sourcesContent":["import { captureException, withScope } from '@sentry/core';\n\ntype RequestInfo = {\n  url: string;\n  method: string;\n  headers: Record<string, string | string[] | undefined>;\n};\n\ntype ErrorContext = {\n  routerKind: string; // 'Pages Router' | 'App Router'\n  routePath: string;\n  routeType: string; // 'render' | 'route' | 'middleware'\n};\n\n/**\n * Reports errors for the Next.js `onRequestError` instrumentation hook.\n *\n * Notice: This function is experimental and not intended for production use. Breaking changes may be done to this funtion in any release.\n *\n * @experimental\n */\nexport function experimental_captureRequestError(\n  error: unknown,\n  request: RequestInfo,\n  errorContext: ErrorContext,\n): void {\n  withScope(scope => {\n    scope.setSDKProcessingMetadata({\n      request: {\n        headers: request.headers,\n        method: request.method,\n      },\n    });\n\n    scope.setContext('nextjs', {\n      request_path: request.url,\n      router_kind: errorContext.routerKind,\n      router_path: errorContext.routePath,\n      route_type: errorContext.routeType,\n    });\n\n    scope.setTransactionName(errorContext.routePath);\n\n    captureException(error, {\n      mechanism: {\n        handled: false,\n      },\n    });\n  });\n}\n"],"names":[],"mappings":";;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS,gCAAgC;AAChD,EAAE,KAAK;AACP,EAAE,OAAO;AACT,EAAE,YAAY;AACd,EAAQ;AACR,EAAE,SAAS,CAAC,KAAA,IAAS;AACrB,IAAI,KAAK,CAAC,wBAAwB,CAAC;AACnC,MAAM,OAAO,EAAE;AACf,QAAQ,OAAO,EAAE,OAAO,CAAC,OAAO;AAChC,QAAQ,MAAM,EAAE,OAAO,CAAC,MAAM;AAC9B,OAAO;AACP,KAAK,CAAC,CAAA;AACN;AACA,IAAI,KAAK,CAAC,UAAU,CAAC,QAAQ,EAAE;AAC/B,MAAM,YAAY,EAAE,OAAO,CAAC,GAAG;AAC/B,MAAM,WAAW,EAAE,YAAY,CAAC,UAAU;AAC1C,MAAM,WAAW,EAAE,YAAY,CAAC,SAAS;AACzC,MAAM,UAAU,EAAE,YAAY,CAAC,SAAS;AACxC,KAAK,CAAC,CAAA;AACN;AACA,IAAI,KAAK,CAAC,kBAAkB,CAAC,YAAY,CAAC,SAAS,CAAC,CAAA;AACpD;AACA,IAAI,gBAAgB,CAAC,KAAK,EAAE;AAC5B,MAAM,SAAS,EAAE;AACjB,QAAQ,OAAO,EAAE,KAAK;AACtB,OAAO;AACP,KAAK,CAAC,CAAA;AACN,GAAG,CAAC,CAAA;AACJ;;;;"}